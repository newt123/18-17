.TH JAMBASE 5 "30 August 1993"
.SH NAME
\fBJambase\fR \- \fBjam\fR(1) boilerplate
.SH FILES
\fB/usr/local/lib/jam/Jambase\fR
.br
\fBJamfile\fR

.SH DESCRIPTION
.PP
\fBJambase\fR contains a set of \fBjam\fR rule definitions that provide
roughly \fBmake\fR(1)-like functionality.  \fBJam\fR reads
\fBJambase\fR, which in turn includes the \fBJamfile\fR from the
current directory.  This manual page lists the rules and variables
defined in \fBJambase\fR.  For a more readable guide to writing a
\fBJamfile\fR, see \fBJamfile\fR(5).
.SS Rules
.PP
\fBJam\fR normally tries to build the dependents of the target
\fIall\fR.  \fBJambase\fR defines the following dependents of
\fIall\fR:  \fIexe\fR, \fIfiles\fR, \fIinstall\fR, \fIlib\fR, and
\fIshell\fR.  Many of the rules defined below make their targets
dependents of one of these.
.de RP
.IP "\\$1"
.IP
..
.RP "Bulk directory : sources ;"
Copies \fIsources\fR into \fIdirectory\fR. Dependents of \fIfiles\fR.
.RP "Cc object : source ;"
Compile the file \fIsource\fR into \fIobject\fR, using the C compiler
$(CC), its flags $(CCFLAGS) and $(OPTIM), and the header file directories
$(HDRS).  Called by the \fIObject\fR rule.
.RP "CcAddFlags source : flags ;"
Add \fIflags\fR to the \fIsource\fR-specific value of $(CCFLAGS) when
compiling \fIsource\fR.
.RP "CcAddHdrs source : dirs ;"
Add \fIdirs\fR to the \fIsource\fR-specific value of $(HDRS) when
scanning and compiling \fIsource\fR.
.RP "Clean clean : targets ;"
Removes existing \fItargets\fR when \fIclean\fR is built.  \fIclean\fR
is not a dependency of \fIall\fR, and must be built explicitly for
\fItargets\fR to be removed.  
.RP "File target : source ;"
Copies \fIsource\fR into \fItarget\fR.  Dependent of \fIfiles\fR.
.RP "HdrRule source : headers ;"
Arranges the proper dependencies when the file \fIsource\fR 
includes the files \fIheaders\fR through the "#include" C preprocessor
directive.  The \fIObject\fR rule arranges for this rule to be called
when \fBJam\fI does its header file scan of \fIsource\fR.
.RP "InstallBin sources ; "
Copy \fIsources\fR into $(BINDIR).  Dependents of \fIinstall\fR.
.RP "InstallLib sources ;"
Copy \fIsources\fR into $(LIBDIR).  Dependents of \fIinstall\fR.
.RP "InstallMan sources ;"
Copy \fIsources\fR into the appropriate subdirectory of
$(MANDIR).  Dependents of \fIinstall\fR.
.RP "Lex source.c : source.l ;"
Process the \fBlex\fR(1) source file \fIsource.l\fR and rename the 
lex.yy.c to \fIsource.c\fR.  Called by the \fIObject\fR rule.
.RP "Library library : sources ;"
Compiles \fIsources\fR and archives them into \fIlibrary\fR.  The
intermediate objects are deleted.  Dependent of \fIlib\fR.
.RP "LinkLibraries image : libraries ;"
Makes \fIimage\fR depend on \fIlibraries\fR and includes them during
the linking.
.RP "Main image : sources ;"
Compiles \fIsources\fR and links them into \fIimage\fR.
Dependent of \fIexe\fR.
.RP "Object object : source ;"
Compiles a single source file \fIsource\fR into \fIobject\fR.  This
rule is used by \fBMain\fR and \fBLibrary\fR.  Makes \fIobject\fR
depend on all header files included by \fIsource\fR.  Such dependencies
are "soft": missing headers are not an error.
.IP
For \fIsource\fR, the following suffixes are recognized:
.RS
.IP .c
C source file
.IP .C
C++ source file
.IP .l
\fIlex\fR(1) source file.  The resulting lex.yy.c is 
renamed to the same base as \fIsource\fR.
\fIobject\fR.
.IP .y
\fIyacc\fR(1) source file.  The resulting y.tab.c and y.tab.h are
renamed to the same base as \fIsource\fR.
.PP
All other suffixes are passed to the rule
.IP
UserObject object : source ;
.PP
to be defined in the user's \fBJamfile\fR (or elsewhere).
.RE
.RP "RmTemps targets : sources ;"
Marks \fIsources\fR as temporary with the \fBTEMPORARY\fR rule, and
deletes \fIsources\fR once \fItargets\fR are built.  Must be the last
rule invoked on \fItargets\fR.  Used internally by \fBObject\fR.
.RP "Setuid image ;"
Sets the setuid bit on \fIimage\fR after linking.
.RP "Shell image : source ;"
Copies \fIsource\fR into the executable \fBsh\fR(1) script \fIimage\fR.
Dependent of \fIshell\fR.
.RP "Undefines image : symbols ;"
Tries to convince the loader that symbols need to be "undefined" for
the linking of \fIimage\fR.
.RP "Yacc source.c : source.y ;"
Process the \fByacc\fR(1) file \fIsource.y\fR and renamed the resulting
y.tab.c and y.tab.h to \fIsource.c\fR.  Produces a y.tab.h and renames it
to \fIsource\fR.h.  Called by the \fIObject\fR rule.
.SS Variables
.PP
AR (default \fI"ar ru"\fR)
.IP
The archiver used for \fBLibrary\fR.
.PP
BINDIR (default \fI/usr/local/bin\fR)
.IP
The install directory for \fBInstallBin\fR.
.PP
CC (default \fIcc\fR)
.IP
C compiler used for \fBObject\fR.
.PP
CCFLAGS (no default)
.IP
Flags handed to the C compiler for \fBObject\fR.  \fBOPTIM\fR is also
handed to the C compiler.
.PP
EXEMODE (default \fI711\fR)
.IP
Permissions for executables linked with \fBMain\fR.
.PP
FILEMODE (default \fI644\fR)
.IP
Permissions for files copied by \fBFile\fR or \fBBulk\fR.
.PP
HDRPATTERN (default ^#[\\t ]*include[\\t ]*[<"](.*)[">].*$)
.IP
The \fBregexp\fR(3) pattern for finding header file includes in source
files.  The \fBObject\fR rule sets the \fBjam\fR special variable
\fBHDRSCAN\fR to $(\fBHDRPATTERN\fR) for all of its sources.  The
\fBObject\fR target depends on all header files found.
.PP
HDRS (no default)
.IP
Directories to be scanned for header files and handed to the C compiler
with -I.  The \fBObject\fR rule sets \fBHDRS\fR to $(HDRS) for each of
its sources.
.PP
LEX (default \fIlex\fR )
.IP
The \fBlex\fR(1) command and flags.
.PP
LIBDIR (default \fI/usr/local/lib\fR)
.IP
The target directory for \fBInstallLib\fR.
.PP
LINK (default \fIcc\fR)
.IP
The linker.
.PP
LINKFLAGS (default \fI$(CCFLAGS)\fR)
.IP
Flags handed to the linker.
.PP
LINKLIBS (no default)
.IP
Libraries to hand to the linker.  The target image does not depend on
these libraries.
.PP
LOCATE_TARGET (no default)
.IP
The directory for object modules and other intermediate files generated
by \fBObject\fR.  This works by setting the \fBjam\fR special variable
\fBLOCATE\fR to the value of $(\fBLOCATE_TARGET\fR) for each of
\fBObject\fR's targets.
.PP
MV (default \fImv -f\fR)
.IP
The file rename command and options.
.PP
OPTIM (default \fI-O\fR)
.IP
More flags handed to the C compiler.
.PP
RANLIB (default \fIranlib\fR)
.IP
If set, the command string to be invoked on each library after
archiving.
.PP
RM (default \fIrm -f\fR)
.IP
The command and options to remove a file.
.PP
SEARCH_SOURCE (no default)
.IP
The directory to find sources listed with \fBMain\fR, \fBLibrary\fR,
\fBObject\fR, \fBBulk\fR, \fBFile\fR, \fBShell\fR, \fBInstallBin\fR,
\fBInstallLib\fR, and \fBInstallMan\fR rules.  This works by setting
the \fBjam\fR special variable \fBSEARCH\fR to the value of
$(\fBSEARCH_SOURCE\fR) for each of the rules' sources.
.PP
SHELLHEADER (default \fI#!/bin/sh\fR)
.IP
A string inserted to the first line of every file created by the
\fBShell\fR rule.
.PP
SHELLMODE (default \fI755\fR)
.IP
Permissions for files installed by \fBShell\fR.
.PP
STDHDRS (default \fI/usr/include\fR)
.IP
Directories where headers can be found without resorting to using the
\fIflag\fR to the C compiler.
.PP
UNDEFFLAG (default \fI-u _\fR)
.IP
The flag prefixed to each symbol for the \fBUndefines\fR rule.
.PP
YACc (default \fIyacc -d\fR)
.IP
The \fByacc\fR(1) command and flags.
.PP
JAMFILE (default \fIJamfile\fR)
.IP
The user provided file listing the sources to be built.

.SH BUGS
.PP
Because libraries are passed unbound to the \fBLink\fR rule as
$(\fBNEEDLIBS\fR), they cannot be located with $(\fBLOCATE\fR), because
$(\fBLOCATE\fR) only changes the bound file name.
.PP
There's no \fByacc\fR(1) on VMS, so the guts of the rules are commented
out.

.SH EXAMPLES
.PP
.de XB
Example:
.RS
.IP
.ft CW
..
.de XE
.RE
.ft R
..
.XB
Main myprog : main.c util.c ;
.XE
.XB
LinkLibraries myprog : libstring.a libtree.a ;
.XE
.XB
Setuid myprog ;
.XE
.XB
Undefines myprog : treeinit ;
.XE
.XB
Library libstring.a : strcmp.c strcpy.c strlen.c ;
.XE
.XB
Object strcmp.o : strcmp.c ;
.XE
.XB
Bulk /usr/local/man/man1 : jam.1 myprog.1 ;
.XE
.XB
File /usr/local/lib/help.txt : help.txt ;
.XE
